import{r as n,c as h,q as de,a as p,o as r,b as i,d as a,h as ce,e as u,f as s,s as ve,k as F,j as b,t as v,n as pe,v as j,i as fe,F as me,p as m}from"./app-Cn6IejnY.js";import{D as f,_ as ye}from"./AppSidebarLayout.vue_vue_type_script_setup_true_lang-CpsvYbYf.js";import{s as xe,a as y}from"./index-CKljO2JX.js";import{s as $}from"./index-bfg_XAYG.js";import{s as ge}from"./index-cgrTJExZ.js";import{s as he}from"./index-B1UQifbm.js";import{s as be}from"./index-CBxa_VPz.js";import{s as O}from"./index-D_mTPtjg.js";import{s as L}from"./index-C7JM5_Ot.js";import{_ as I}from"./DeleteConfirmationModal-CurhxZsU.js";import"./index-BDoZbogT.js";import"./useForwardExpose-CIteLJoH.js";import"./VisuallyHidden-L5y81zSm.js";import"./RovingFocusGroup-CaLZOjRo.js";import"./createLucideIcon-U8lhmqUJ.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./index-BLtObZYw.js";import"./index-2D8v8uAD.js";import"./index-VTumJSU4.js";import"./index-CwfaN-Nq.js";import"./index-DBJfqB88.js";import"./index-BLX5XkD2.js";import"./index-B1F1boKX.js";import"./index-DBTNRQsU.js";import"./index-CYEWI1OG.js";import"./index-DruUjrsY.js";import"./index-BI9BsUEE.js";const we={class:"flex flex-col gap-6 p-6"},_e={class:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4"},De={class:"w-full sm:w-auto search-input-wrapper"},ke={class:"flex gap-2"},Ve={class:"relative inline-block"},Ce={key:1,class:"absolute -top-1 -right-1 bg-red-500 text-white text-xs font-semibold rounded-full h-5 w-5 flex items-center justify-center shadow-lg border-2 border-white",style:{"min-width":"1.25rem"}},Se={class:"relative inline-block"},Ae={key:0,class:"absolute -top-1 -right-1 bg-green-500 text-white text-xs font-semibold rounded-full h-5 w-5 flex items-center justify-center shadow-lg border-2 border-white",style:{"min-width":"1.25rem"}},$e={class:"data-table-container"},Fe={class:"overflow-x-auto"},Le={key:0,class:"text-center py-12"},Ne={class:"flex items-center h-full"},Ue={class:"text-sm text-gray-600"},je={class:"flex flex-col"},Be={class:"flex items-center gap-2"},Te={class:"font-medium text-gray-900"},Ee={key:0,class:"text-xs text-gray-500 truncate max-w-xs"},Pe={class:"font-medium"},Re={class:"flex flex-col text-xs"},Me={class:"flex items-center gap-3"},Oe=["onClick"],Ie=["onClick"],Ke=["onClick"],qe={class:"flex flex-col gap-6"},ze={class:"flex flex-col gap-2"},Ge={class:"flex flex-col gap-2"},He={key:0,class:"text-sm text-gray-600 bg-blue-50 p-3 rounded-lg"},Je={class:"flex gap-2 justify-end"},_t={__name:"Index",props:{discounts:{type:Array,default:()=>[]},statistics:{type:Object,default:()=>({})},filters:{type:Object,default:()=>({is_active:null,type:null,search:null})}},setup(K){const d=K,w=n(d.filters?.search||""),c=n([]),B=n(0),N=n(10),_=n(!1),o=n({isActive:d.filters?.is_active?Array.isArray(d.filters.is_active)?d.filters.is_active:[d.filters.is_active]:[],type:d.filters?.type?Array.isArray(d.filters.type)?d.filters.type:[d.filters.type]:[]}),q=[{label:"Active",value:!0},{label:"Inactive",value:!1}],z=[{label:"Percentage",value:"percentage"},{label:"Fixed",value:"fixed"}],D=n(!1),x=n(!1),k=n(null),V=n(""),C=n(!1),g=n(!1),T=h(()=>d.discounts),G=h(()=>[{title:"Dashboard",href:"/dashboard"},{title:"Discounts",href:f.index.url()}]),H=l=>B.value*N.value+l+1,J=l=>{B.value=l.page,N.value=l.rows},Q=l=>{m.visit(f.show.url(l))},W=l=>{m.visit(f.edit.url(l))},X=(l,e)=>{k.value=l,V.value=e,D.value=!0,x.value=!1},Y=()=>{k.value&&(x.value=!0,m.delete(f.destroy.url(k.value),{preserveScroll:!0,onSuccess:()=>{x.value=!1,D.value=!1,k.value=null,V.value=""},onError:()=>{x.value=!1},onFinish:()=>{x.value=!1}}))},Z=()=>{D.value=!1,k.value=null,V.value="",x.value=!1},ee=h(()=>V.value?`Are you sure you want to delete "${V.value}"?`:"Are you sure you want to delete this discount?"),te=()=>{m.visit(f.create.url())},le=l=>{m.post(f.toggleStatus.url(l),{},{preserveScroll:!0})},S=h(()=>{let l=0;return o.value.isActive&&o.value.isActive.length>0&&l++,o.value.type&&o.value.type.length>0&&l++,l}),E=(l=!0)=>{const e={};o.value.isActive&&o.value.isActive.length>0&&(e.is_active=o.value.isActive),o.value.type&&o.value.type.length>0&&(e.type=o.value.type),w.value&&(e.search=w.value),m.get(f.index.url(),e,{preserveState:!0,preserveScroll:!0,onSuccess:()=>{l&&(_.value=!1)}})},se=()=>{o.value={isActive:[],type:[]},w.value="",m.get(f.index.url(),{},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{_.value=!1}})},ae=()=>{c.value.length!==0&&(C.value=!0,g.value=!1)},ie=()=>{if(c.value.length===0)return;g.value=!0;const l=c.value.map(e=>e.id);m.post(f.bulkDelete.url(),{ids:l},{preserveScroll:!0,onSuccess:()=>{g.value=!1,C.value=!1,c.value=[]},onError:()=>{g.value=!1},onFinish:()=>{g.value=!1}})},oe=()=>{C.value=!1,g.value=!1},re=h(()=>{const l=c.value.length;return l===0?"":`Are you sure you want to delete ${l} ${l===1?"discount":"discounts"}?`}),P=h(()=>c.value&&c.value.length>0),R=l=>l?new Date(l).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",ne=l=>l.type==="percentage"?`${l.value}%`:`$${parseFloat(l.value).toFixed(2)}`,ue=l=>new Date(l.end_date)<new Date,M=l=>{if(!l.is_active)return!1;const e=new Date,A=new Date(l.start_date),t=new Date(l.end_date);return e>=A&&e<=t};return(l,e)=>{const A=de("tooltip");return r(),p(me,null,[i(a(ce),{title:"Discounts"}),i(ye,{title:"Discounts",breadcrumbs:G.value},{default:u(()=>[s("div",we,[s("div",_e,[s("div",De,[e[8]||(e[8]=s("i",{class:"pi pi-search search-icon"},null,-1)),i(a(ge),{modelValue:w.value,"onUpdate:modelValue":e[0]||(e[0]=t=>w.value=t),placeholder:"Search",class:"w-full",onKeyup:ve(E,["enter"])},null,8,["modelValue"])]),s("div",ke,[s("div",Ve,[P.value?(r(),F(a($),{key:0,label:"Delete Selected",icon:"pi pi-trash",severity:"danger",outlined:"",class:"flex-shrink-0",onClick:ae})):b("",!0),P.value?(r(),p("span",Ce,v(c.value.length),1)):b("",!0)]),s("div",Se,[i(a($),{label:"Filters",icon:"pi pi-filter",severity:"secondary",outlined:"",class:"flex-shrink-0",onClick:e[1]||(e[1]=t=>_.value=!0)}),S.value>0?(r(),p("span",Ae,v(S.value),1)):b("",!0)]),i(a($),{label:"Add Discount",icon:"pi pi-plus",severity:"primary",onClick:te,class:"flex-shrink-0"})])]),s("div",$e,[s("div",Fe,[T.value.length===0?(r(),p("div",Le,[...e[9]||(e[9]=[s("i",{class:"pi pi-inbox text-4xl text-gray-400 mb-3"},null,-1),s("p",{class:"text-gray-500"},"No discounts found",-1)])])):(r(),F(a(xe),{key:1,value:T.value,paginator:!0,rows:N.value,rowsPerPageOptions:[5,10,20,50],selection:c.value,"onUpdate:selection":e[2]||(e[2]=t=>c.value=t),paginatorTemplate:"RowsPerPageDropdown FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport",currentPageReportTemplate:"{first} to {last} of {totalRecords}",class:"p-datatable-sm",stripedRows:"",dataKey:"id",globalFilterFields:["name","code","description"],onPage:J},{default:u(()=>[i(a(y),{selectionMode:"multiple",headerStyle:"width: 3rem"}),i(a(y),{header:"#",style:{width:"60px"}},{body:u(t=>[s("div",Ne,[s("span",Ue,v(H(t.index)),1)])]),_:1}),i(a(y),{field:"name",header:"Discount Name",sortable:!0},{body:u(t=>[s("div",je,[s("div",Be,[s("span",Te,v(t.data.name),1),i(a(L),{value:t.data.code,severity:"info",class:"text-xs"},null,8,["value"])]),t.data.description?(r(),p("span",Ee,v(t.data.description),1)):b("",!0)])]),_:1}),i(a(y),{field:"type",header:"Type",sortable:!0,style:{width:"100px"}},{body:u(t=>[i(a(L),{value:t.data.type==="percentage"?"Percentage":"Fixed",severity:t.data.type==="percentage"?"success":"warning"},null,8,["value","severity"])]),_:1}),i(a(y),{header:"Value",style:{width:"100px"}},{body:u(t=>[s("span",Pe,v(ne(t.data)),1)]),_:1}),i(a(y),{header:"Validity",style:{width:"200px"}},{body:u(t=>[s("div",Re,[s("span",{class:pe(M(t.data)?"text-green-600":"text-gray-500")},v(R(t.data.start_date))+" - "+v(R(t.data.end_date)),3),ue(t.data)?(r(),F(a(L),{key:0,value:"Expired",severity:"danger",class:"text-xs mt-1"})):M(t.data)?(r(),F(a(L),{key:1,value:"Active",severity:"success",class:"text-xs mt-1"})):b("",!0)])]),_:1}),i(a(y),{field:"is_active",header:"Status",sortable:!0,sortField:"is_active",style:{width:"120px"}},{body:u(t=>[i(a(he),{modelValue:t.data.is_active,"onUpdate:modelValue":U=>le(t.data.id)},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),i(a(y),{header:"Actions",style:{width:"100px"}},{body:u(t=>[s("div",Me,[j((r(),p("button",{onClick:U=>Q(t.data.id),class:"text-gray-600 cursor-pointer"},[...e[10]||(e[10]=[s("i",{class:"pi pi-eye text-sm"},null,-1)])],8,Oe)),[[A,"View",void 0,{top:!0}]]),j((r(),p("button",{onClick:U=>W(t.data.id),class:"text-blue-600 cursor-pointer"},[...e[11]||(e[11]=[s("i",{class:"pi pi-pencil text-sm"},null,-1)])],8,Ie)),[[A,"Edit",void 0,{top:!0}]]),j((r(),p("button",{onClick:U=>X(t.data.id,t.data.name),class:"text-red-600 cursor-pointer"},[...e[12]||(e[12]=[s("i",{class:"pi pi-trash text-sm"},null,-1)])],8,Ke)),[[A,"Delete",void 0,{top:!0}]])])]),_:1})]),_:1},8,["value","rows","selection"]))])])]),i(I,{visible:D.value,"onUpdate:visible":e[3]||(e[3]=t=>D.value=t),title:"Delete Discount",message:ee.value,loading:x.value,onConfirm:Y,onCancel:Z},null,8,["visible","message","loading"]),i(I,{visible:C.value,"onUpdate:visible":e[4]||(e[4]=t=>C.value=t),title:"Delete Discounts",message:re.value,loading:g.value,onConfirm:ie,onCancel:oe},null,8,["visible","message","loading"]),i(a(be),{visible:_.value,"onUpdate:visible":e[7]||(e[7]=t=>_.value=t),position:"right",class:"w-full sm:w-96",modal:!0,dismissable:!0},{header:u(()=>[...e[13]||(e[13]=[s("div",{class:"flex items-center justify-between w-full pr-8"},[s("h2",{class:"text-xl font-semibold"},"Filters")],-1)])]),footer:u(()=>[s("div",Je,[i(a($),{label:"Reset",severity:"secondary",outlined:"",onClick:se}),i(a($),{label:"Apply Filters",severity:"primary",onClick:E})])]),default:u(()=>[s("div",qe,[s("div",ze,[e[14]||(e[14]=s("label",{class:"text-sm font-medium text-gray-700"},"Status",-1)),i(a(O),{modelValue:o.value.isActive,"onUpdate:modelValue":e[5]||(e[5]=t=>o.value.isActive=t),options:q,optionLabel:"label",optionValue:"value",placeholder:"Select Status",class:"w-full",display:"chip",showClear:!0},null,8,["modelValue"])]),s("div",Ge,[e[15]||(e[15]=s("label",{class:"text-sm font-medium text-gray-700"},"Type",-1)),i(a(O),{modelValue:o.value.type,"onUpdate:modelValue":e[6]||(e[6]=t=>o.value.type=t),options:z,optionLabel:"label",optionValue:"value",placeholder:"Select Type",class:"w-full",display:"chip",showClear:!0},null,8,["modelValue"])]),S.value>0?(r(),p("div",He,[e[16]||(e[16]=s("i",{class:"pi pi-info-circle mr-2"},null,-1)),fe(" "+v(S.value)+" "+v(S.value===1?"filter":"filters")+" active ",1)])):b("",!0)])]),_:1},8,["visible"])]),_:1},8,["breadcrumbs"])],64)}}};export{_t as default};
