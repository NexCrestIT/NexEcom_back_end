import{u as K,r as y,c as k,m as G,a as g,o as _,b as o,d as s,h as H,e as J,f as l,g as Q,i as v,n as i,j as F,t as V,F as D,l as W,v as X,y as Y,p as Z}from"./app-nZ486FH-.js";import{_ as n}from"./InputError.vue_vue_type_script_setup_true_lang-BA97093D.js";import{F as S,_ as ee}from"./AppSidebarLayout.vue_vue_type_script_setup_true_lang-DlZa9EoC.js";import{s as x}from"./index-TtdGbCEO.js";import{s as h}from"./index-BpaVQjfu.js";import{s as C}from"./index-BmdAbA5q.js";import{s as P}from"./index-C_efGWwB.js";import{s as U}from"./index-CdsES4qx.js";import{s as b}from"./index-D29InjjQ.js";import{s as B}from"./index-ChGQEvVp.js";import{s as se}from"./index-CWG0HDUv.js";import"./index-CHK9YDbT.js";import"./useForwardExpose-DRgSMGS6.js";import"./VisuallyHidden-Ctde3iQv.js";import"./RovingFocusGroup-BJ6ex-50.js";import"./createLucideIcon-IGbS4iJz.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./index-BLtObZYw.js";import"./index-D-YufhEa.js";import"./index-wUJh2Se0.js";import"./index-DDdz4gGK.js";import"./index-BGmOkUyG.js";import"./index-za1w8YqQ.js";import"./index-C7B-TJjG.js";import"./index-D4tZdGpa.js";import"./index-DcpomhCc.js";const le={class:"flex flex-col gap-4 p-6"},te={class:"rounded-lg border border-border bg-card p-6"},ae={class:"space-y-4"},oe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},de={class:"flex flex-col gap-2"},re={class:"flex flex-col gap-2"},ie={class:"flex flex-col gap-2"},ne={class:"space-y-4"},ue={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},me={class:"flex flex-col gap-2"},pe={class:"flex flex-col gap-2"},ce={class:"space-y-4"},fe={class:"flex flex-col gap-4"},ge={key:0,class:"relative inline-block"},_e=["src"],ve={class:"space-y-4"},xe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},be={class:"flex flex-col gap-2"},ye={class:"flex flex-col gap-2"},Ve={class:"text-muted-foreground"},Se={class:"flex flex-col gap-2"},he={class:"space-y-4"},we={class:"flex items-center justify-between border-b pb-2"},ke={key:0,class:"text-center py-4 text-gray-500"},Ue={class:"flex items-center justify-between mb-2"},$e={class:"text-sm font-medium"},Fe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},De={class:"flex flex-col gap-2"},Ce={class:"flex flex-col gap-2"},Pe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Be={class:"flex flex-col gap-2"},Ee={class:"flex flex-col gap-2"},Le={class:"space-y-4"},Me={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ze={class:"flex items-center gap-3"},Oe={class:"flex items-center gap-3"},Te={class:"flex flex-col gap-2"},je={class:"space-y-4"},Ae={class:"space-y-4"},Ie={class:"flex flex-col gap-2"},Ne={class:"text-muted-foreground"},Re={class:"flex flex-col gap-2"},qe={class:"text-muted-foreground"},Ke={class:"flex flex-col gap-2"},Ge={class:"flex justify-end gap-2 mt-4 pt-4 border-t"},bs={__name:"Edit",props:{flashSale:{type:Object,required:!0},products:{type:Array,default:()=>[]}},setup(w){const d=w,t=K({_method:"PUT",name:d.flashSale.name||"",slug:d.flashSale.slug||"",description:d.flashSale.description||"",start_date:d.flashSale.start_date?new Date(d.flashSale.start_date):null,end_date:d.flashSale.end_date?new Date(d.flashSale.end_date):null,banner_image:null,discount_type:d.flashSale.discount_type||"percentage",discount_value:d.flashSale.discount_value?parseFloat(d.flashSale.discount_value):null,max_products:d.flashSale.max_products||null,is_active:d.flashSale.is_active??!0,is_featured:d.flashSale.is_featured??!1,sort_order:d.flashSale.sort_order||0,meta_title:d.flashSale.meta_title||"",meta_description:d.flashSale.meta_description||"",meta_keywords:d.flashSale.meta_keywords||"",remove_banner_image:!1,products:[]}),p=y(null),c=y(!1),m=y([]),E=y(d.flashSale.banner_image),$=[{label:"Percentage",value:"percentage"},{label:"Fixed Amount",value:"fixed"}],L=k(()=>t.discount_type==="percentage"?100:null),M=k(()=>d.products.map(r=>({id:r.id,name:`${r.name} (${r.sku}) - $${r.price}`}))),z=k(()=>[{title:"Dashboard",href:"/dashboard"},{title:"Flash Sales",href:S.index.url()},{title:`Edit: ${d.flashSale.name}`,href:S.edit.url(d.flashSale.id)}]),O=()=>{t.name&&(t.slug=t.name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,""))},T=r=>{const e=r.files[0];if(e){t.banner_image=e,t.remove_banner_image=!1;const a=new FileReader;a.onload=f=>{p.value=f.target.result},a.readAsDataURL(e)}},j=()=>{t.banner_image=null,t.remove_banner_image=!0,p.value=null,E.value=null},A=()=>{d.flashSale.products&&d.flashSale.products.length>0&&(m.value=d.flashSale.products.map(r=>({product_id:r.id,discount_type:r.pivot.discount_type||null,discount_value:r.pivot.discount_value?parseFloat(r.pivot.discount_value):null,sort_order:r.pivot.sort_order||0})))},I=()=>{m.value.push({product_id:null,discount_type:null,discount_value:null,sort_order:0})},N=r=>{m.value.splice(r,1)};G(()=>{d.flashSale.banner_image_url&&(p.value=d.flashSale.banner_image_url),A(),(d.flashSale.meta_title||d.flashSale.meta_description||d.flashSale.meta_keywords)&&(c.value=!0)});const R=()=>{const r=m.value.filter(e=>e.product_id).map(e=>({product_id:e.product_id,discount_type:e.discount_type||null,discount_value:e.discount_value||null,sort_order:e.sort_order||0}));t.transform(e=>({...e,products:r})).post(S.update.url(d.flashSale.id),{preserveScroll:!0,forceFormData:!0})},q=()=>{Z.visit(S.index.url())};return(r,e)=>(_(),g(D,null,[o(s(H),{title:`Edit: ${w.flashSale.name}`},null,8,["title"]),o(ee,{title:`Edit: ${w.flashSale.name}`,breadcrumbs:z.value},{default:J(()=>[l("div",le,[l("div",te,[l("form",{onSubmit:Q(R,["prevent"]),class:"flex flex-col gap-6"},[l("div",ae,[e[19]||(e[19]=l("h3",{class:"text-lg font-semibold border-b pb-2"},"Basic Information",-1)),l("div",oe,[l("div",de,[e[15]||(e[15]=l("label",{for:"name",class:"text-sm font-medium"},[v(" Flash Sale Name "),l("span",{class:"text-red-500"},"*")],-1)),o(s(h),{id:"name",modelValue:s(t).name,"onUpdate:modelValue":e[0]||(e[0]=a=>s(t).name=a),placeholder:"Enter flash sale name...",onBlur:O,class:i([{"p-invalid":s(t).errors.name},"w-full"])},null,8,["modelValue","class"]),o(n,{message:s(t).errors.name},null,8,["message"])]),l("div",re,[e[16]||(e[16]=l("label",{for:"slug",class:"text-sm font-medium"},"Slug",-1)),o(s(h),{id:"slug",modelValue:s(t).slug,"onUpdate:modelValue":e[1]||(e[1]=a=>s(t).slug=a),placeholder:"flash-sale-slug",class:i([{"p-invalid":s(t).errors.slug},"w-full"])},null,8,["modelValue","class"]),e[17]||(e[17]=l("small",{class:"text-muted-foreground"},"Leave empty to auto-generate",-1)),o(n,{message:s(t).errors.slug},null,8,["message"])])]),l("div",ie,[e[18]||(e[18]=l("label",{for:"description",class:"text-sm font-medium"},"Description",-1)),o(s(C),{id:"description",modelValue:s(t).description,"onUpdate:modelValue":e[2]||(e[2]=a=>s(t).description=a),placeholder:"Enter flash sale description...",class:i([{"p-invalid":s(t).errors.description},"w-full"]),rows:"3"},null,8,["modelValue","class"]),o(n,{message:s(t).errors.description},null,8,["message"])])]),l("div",ne,[e[22]||(e[22]=l("h3",{class:"text-lg font-semibold border-b pb-2"},"Date Range",-1)),l("div",ue,[l("div",me,[e[20]||(e[20]=l("label",{for:"start_date",class:"text-sm font-medium"},[v(" Start Date "),l("span",{class:"text-red-500"},"*")],-1)),o(s(B),{id:"start_date",modelValue:s(t).start_date,"onUpdate:modelValue":e[3]||(e[3]=a=>s(t).start_date=a),showTime:"",hourFormat:"12",class:i([{"p-invalid":s(t).errors.start_date},"w-full"])},null,8,["modelValue","class"]),o(n,{message:s(t).errors.start_date},null,8,["message"])]),l("div",pe,[e[21]||(e[21]=l("label",{for:"end_date",class:"text-sm font-medium"},[v(" End Date "),l("span",{class:"text-red-500"},"*")],-1)),o(s(B),{id:"end_date",modelValue:s(t).end_date,"onUpdate:modelValue":e[4]||(e[4]=a=>s(t).end_date=a),showTime:"",hourFormat:"12",class:i([{"p-invalid":s(t).errors.end_date},"w-full"])},null,8,["modelValue","class"]),o(n,{message:s(t).errors.end_date},null,8,["message"])])])]),l("div",ce,[e[24]||(e[24]=l("h3",{class:"text-lg font-semibold border-b pb-2"},"Banner Image",-1)),l("div",fe,[p.value?(_(),g("div",ge,[l("img",{src:p.value,alt:"Banner preview",class:"h-48 w-full object-cover rounded-lg border"},null,8,_e),o(s(x),{type:"button",icon:"pi pi-times",severity:"danger",size:"small",rounded:"",class:"absolute -top-2 -right-2",onClick:j})])):F("",!0),o(s(se),{mode:"basic",accept:"image/*",maxFileSize:5e6,chooseLabel:"Choose Banner Image",auto:!1,onSelect:T}),e[23]||(e[23]=l("small",{class:"text-muted-foreground"},"Max size: 5MB",-1)),o(n,{message:s(t).errors.banner_image},null,8,["message"])])]),l("div",ve,[e[29]||(e[29]=l("h3",{class:"text-lg font-semibold border-b pb-2"},"Discount Settings",-1)),l("div",xe,[l("div",be,[e[25]||(e[25]=l("label",{for:"discount_type",class:"text-sm font-medium"},[v(" Discount Type "),l("span",{class:"text-red-500"},"*")],-1)),o(s(U),{id:"discount_type",modelValue:s(t).discount_type,"onUpdate:modelValue":e[5]||(e[5]=a=>s(t).discount_type=a),options:$,optionLabel:"label",optionValue:"value",class:i([{"p-invalid":s(t).errors.discount_type},"w-full"])},null,8,["modelValue","class"]),o(n,{message:s(t).errors.discount_type},null,8,["message"])]),l("div",ye,[e[26]||(e[26]=l("label",{for:"discount_value",class:"text-sm font-medium"},"Discount Value",-1)),o(s(b),{id:"discount_value",modelValue:s(t).discount_value,"onUpdate:modelValue":e[6]||(e[6]=a=>s(t).discount_value=a),min:0,max:L.value,suffix:s(t).discount_type==="percentage"?"%":"$",class:i([{"p-invalid":s(t).errors.discount_value},"w-full"])},null,8,["modelValue","max","suffix","class"]),l("small",Ve,V(s(t).discount_type==="percentage"?"Percentage discount (0-100)":"Fixed amount discount"),1),o(n,{message:s(t).errors.discount_value},null,8,["message"])])]),l("div",Se,[e[27]||(e[27]=l("label",{for:"max_products",class:"text-sm font-medium"},"Max Products",-1)),o(s(b),{id:"max_products",modelValue:s(t).max_products,"onUpdate:modelValue":e[7]||(e[7]=a=>s(t).max_products=a),min:1,class:i([{"p-invalid":s(t).errors.max_products},"w-full"])},null,8,["modelValue","class"]),e[28]||(e[28]=l("small",{class:"text-muted-foreground"},"Maximum number of products in this flash sale (optional)",-1)),o(n,{message:s(t).errors.max_products},null,8,["message"])])]),l("div",he,[l("div",we,[e[30]||(e[30]=l("h3",{class:"text-lg font-semibold"},"Products",-1)),o(s(x),{type:"button",label:"Add Product",icon:"pi pi-plus",size:"small",onClick:I})]),m.value.length===0?(_(),g("div",ke,' No products added. Click "Add Product" to add one. ')):F("",!0),(_(!0),g(D,null,W(m.value,(a,f)=>(_(),g("div",{key:f,class:"border rounded-lg p-4 space-y-4"},[l("div",Ue,[l("span",$e,"Product "+V(f+1),1),o(s(x),{type:"button",icon:"pi pi-times",severity:"danger",size:"small",text:"",onClick:u=>N(f)},null,8,["onClick"])]),l("div",Fe,[l("div",De,[e[31]||(e[31]=l("label",{class:"text-sm font-medium"},[v("Product "),l("span",{class:"text-red-500"},"*")],-1)),o(s(U),{modelValue:a.product_id,"onUpdate:modelValue":u=>a.product_id=u,options:M.value,optionLabel:"name",optionValue:"id",placeholder:"Select product...",class:"w-full"},null,8,["modelValue","onUpdate:modelValue","options"])]),l("div",Ce,[e[32]||(e[32]=l("label",{class:"text-sm font-medium"},"Discount Type",-1)),o(s(U),{modelValue:a.discount_type,"onUpdate:modelValue":u=>a.discount_type=u,options:$,optionLabel:"label",optionValue:"value",placeholder:"Use flash sale default",showClear:"",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"]),e[33]||(e[33]=l("small",{class:"text-muted-foreground"},"Leave empty to use flash sale default",-1))])]),l("div",Pe,[l("div",Be,[e[34]||(e[34]=l("label",{class:"text-sm font-medium"},"Discount Value",-1)),o(s(b),{modelValue:a.discount_value,"onUpdate:modelValue":u=>a.discount_value=u,min:0,max:a.discount_type==="percentage"?100:null,suffix:a.discount_type==="percentage"?"%":"$",class:"w-full"},null,8,["modelValue","onUpdate:modelValue","max","suffix"]),e[35]||(e[35]=l("small",{class:"text-muted-foreground"},"Leave empty to use flash sale default",-1))]),l("div",Ee,[e[36]||(e[36]=l("label",{class:"text-sm font-medium"},"Sort Order",-1)),o(s(b),{modelValue:a.sort_order,"onUpdate:modelValue":u=>a.sort_order=u,min:0,class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])])])]))),128))]),l("div",Le,[e[40]||(e[40]=l("h3",{class:"text-lg font-semibold border-b pb-2"},"Status & Flags",-1)),l("div",Me,[l("div",ze,[o(s(P),{modelValue:s(t).is_active,"onUpdate:modelValue":e[8]||(e[8]=a=>s(t).is_active=a),inputId:"is_active"},null,8,["modelValue"]),e[37]||(e[37]=l("label",{for:"is_active",class:"text-sm font-medium cursor-pointer"}," Active ",-1))]),l("div",Oe,[o(s(P),{modelValue:s(t).is_featured,"onUpdate:modelValue":e[9]||(e[9]=a=>s(t).is_featured=a),inputId:"is_featured"},null,8,["modelValue"]),e[38]||(e[38]=l("label",{for:"is_featured",class:"text-sm font-medium cursor-pointer"}," Featured ",-1))])]),l("div",Te,[e[39]||(e[39]=l("label",{for:"sort_order",class:"text-sm font-medium"},"Sort Order",-1)),o(s(b),{id:"sort_order",modelValue:s(t).sort_order,"onUpdate:modelValue":e[10]||(e[10]=a=>s(t).sort_order=a),min:0,class:i([{"p-invalid":s(t).errors.sort_order},"w-full"])},null,8,["modelValue","class"]),o(n,{message:s(t).errors.sort_order},null,8,["message"])])]),l("div",je,[l("div",{class:"flex items-center gap-2 cursor-pointer border-b pb-2",onClick:e[11]||(e[11]=a=>c.value=!c.value)},[l("i",{class:i(c.value?"pi pi-chevron-down":"pi pi-chevron-right")},null,2),e[41]||(e[41]=l("h3",{class:"text-lg font-semibold"},"SEO Settings",-1)),e[42]||(e[42]=l("span",{class:"text-sm text-muted-foreground"},"(optional)",-1))]),X(l("div",Ae,[l("div",Ie,[e[43]||(e[43]=l("label",{for:"meta_title",class:"text-sm font-medium"},"Meta Title",-1)),o(s(h),{id:"meta_title",modelValue:s(t).meta_title,"onUpdate:modelValue":e[12]||(e[12]=a=>s(t).meta_title=a),placeholder:"SEO title...",class:i({"p-invalid":s(t).errors.meta_title})},null,8,["modelValue","class"]),l("small",Ne,V(s(t).meta_title?.length||0)+"/255 characters ",1),o(n,{message:s(t).errors.meta_title},null,8,["message"])]),l("div",Re,[e[44]||(e[44]=l("label",{for:"meta_description",class:"text-sm font-medium"},"Meta Description",-1)),o(s(C),{id:"meta_description",modelValue:s(t).meta_description,"onUpdate:modelValue":e[13]||(e[13]=a=>s(t).meta_description=a),placeholder:"SEO description...",rows:"3",class:i({"p-invalid":s(t).errors.meta_description})},null,8,["modelValue","class"]),l("small",qe,V(s(t).meta_description?.length||0)+"/500 characters ",1),o(n,{message:s(t).errors.meta_description},null,8,["message"])]),l("div",Ke,[e[45]||(e[45]=l("label",{for:"meta_keywords",class:"text-sm font-medium"},"Meta Keywords",-1)),o(s(h),{id:"meta_keywords",modelValue:s(t).meta_keywords,"onUpdate:modelValue":e[14]||(e[14]=a=>s(t).meta_keywords=a),placeholder:"keyword1, keyword2, keyword3...",class:i({"p-invalid":s(t).errors.meta_keywords})},null,8,["modelValue","class"]),o(n,{message:s(t).errors.meta_keywords},null,8,["message"])])],512),[[Y,c.value]])]),l("div",Ge,[o(s(x),{type:"button",label:"Cancel",severity:"secondary",outlined:"",onClick:q}),o(s(x),{type:"submit",label:"Update Flash Sale",icon:"pi pi-check",loading:s(t).processing,disabled:s(t).processing},null,8,["loading","disabled"])])],32)])])]),_:1},8,["title","breadcrumbs"])],64))}};export{bs as default};
